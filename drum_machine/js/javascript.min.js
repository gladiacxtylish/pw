$(document).ready(function(){var e=null;soundManager.setup({url:"swfs/",flashVersion:9,useFastPolling:!0,useHighPerformance:!0,onready:function(){soundManager.createSound({id:"sound_0",url:"audios/Grand Piano - Fazioli - major C middle.wav"}).load();soundManager.createSound({id:"sound_1",url:"audios/Grand Piano - Fazioli - major D middle.wav"}).load();soundManager.createSound({id:"sound_2",url:"audios/Grand Piano - Fazioli - major E middle.wav"}).load();soundManager.createSound({id:"sound_3",url:"audios/Grand Piano - Fazioli - major F middle.wav"}).load();
soundManager.createSound({id:"sound_4",url:"audios/Grand Piano - Fazioli - major G middle.wav"}).load();soundManager.createSound({id:"sound_5",url:"audios/Grand Piano - Fazioli - major A middle.wav"}).load();soundManager.createSound({id:"sound_6",url:"audios/Grand Piano - Fazioli - major B middle.wav"}).load();e=[];for(var a=0;7>a;a++)e.push("sound_"+a);setInterval(g.nextInterval,500)}});var f=Backbone.Model.extend({defaults:{graphic:null},initialize:function(){}}),h=Backbone.Collection.extend({model:f}),
k=Backbone.Model.extend({defaults:{enabled:!1,graphic:null},initialize:function(){}}),l=Backbone.Collection.extend({buttons:null,initialize:function(a,b){this.buttons=Array(a);for(var c=0;c<a;c++){this.buttons[c]=Array(b);for(var d=0;d<b;d++)this.buttons[c][d]=new k}},getButton:function(a,b){return this.buttons[a][b]}}),g=new (Backbone.View.extend({initialize:function(){this.row=7;this.column=10;this.indicators=new h;for(var a=0;a<this.column;a++)this.indicators.add(new f);this.buttons=new l(7,10);
this.currentColumn=0;_.bindAll(this,"nextInterval","layerClickHandler");var a=new Kinetic.Stage({container:"drumMachinediv",height:595,width:800}),b=new Kinetic.Layer;b.on("click",this.layerClickHandler);this.createButtonsToLayer(b);this.graphicsLayer=b;a.add(b)},layerClickHandler:function(a){a=a.targetNode;this.buttons.getButton(a.getAttrs().row,a.getAttrs().column).get("enabled")?(a.setFill("#036564"),this.graphicsLayer.draw(),this.buttons.getButton(a.getAttrs().row,a.getAttrs().column).set("enabled",
!1)):(a.setFill("#031634"),this.graphicsLayer.draw(),this.buttons.getButton(a.getAttrs().row,a.getAttrs().column).set("enabled",!0))},createButtonsToLayer:function(a){for(var b=0;b<this.column;b++){var c=new Kinetic.Circle({x:175+50*b,y:100,radius:6,fill:"#CDB380"});a.add(c);this.indicators.at(b).set("graphic",c)}for(b=0;b<this.row;b++)for(c=0;c<this.column;c++){var d=new Kinetic.Rect({x:155+50*c,y:120+50*b,width:40,height:40,fill:"#036564",cornerRadius:10,row:b,column:c,shadow:{color:"black",blur:5,
offset:[2,2],opacity:0.5}});a.add(d);this.buttons.getButton(b,c).set("graphic",d)}},nextInterval:function(){var a=0<=this.currentColumn-1?this.currentColumn-1:this.column-1;console.log("Current column: "+this.currentColumn);this.indicators.at(a).get("graphic").setFill("#CDB380");this.indicators.at(this.currentColumn).get("graphic").setFill("#033649");this.graphicsLayer.draw();for(a=0;a<this.row;a++)this.buttons.getButton(a,this.currentColumn).get("enabled")&&soundManager.play(e[a],{multiShotEvents:!0});
this.currentColumn++;this.currentColumn>=this.column&&(this.currentColumn=0)}}))});